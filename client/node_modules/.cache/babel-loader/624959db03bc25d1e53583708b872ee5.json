{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mohamednasr/Desktop/web/projects/invoce_app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mohamednasr/Desktop/web/projects/invoce_app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/Users/mohamednasr/Desktop/web/projects/invoce_app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/mohamednasr/Desktop/web/projects/invoce_app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/mohamednasr/Desktop/web/projects/invoce_app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import FormField from'./FormField/FormField';import ItemsList from'./ItemsList/ItemsList';import{createInvoice,getInvoices,updateInvoice}from'../../actions/invoices';import{useDispatch,useSelector}from'react-redux';import{toggleFormShow,handleCurrentId}from'../../actions/genralState';import{data,getTotal,getDueDate,updateItemFields}from'../../helpers';import{Container,Typography,MenuItem,Button,Paper,Modal}from'@material-ui/core';import{useHistory}from'react-router-dom';import AddIcon from'@material-ui/icons/Add';import useStyles from'./styles';import{ValidatorForm,SelectValidator}from'react-material-ui-form-validator';import{v4 as uuidv4}from'uuid';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Form=function Form(){var classes=useStyles();var history=useHistory();var dispatch=useDispatch();var showForm=useSelector(function(state){return state.globalState.showForm;});var currentId=useSelector(function(state){return state.globalState.currentId;});var invoice=useSelector(function(state){return currentId?state.invoices.invoices.find(function(invoice){return invoice._id===currentId;}):null;});var _useState=useState(data),_useState2=_slicedToArray(_useState,2),invoiceData=_useState2[0],setInvocieData=_useState2[1];var addItemField=function addItemField(){setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{items:[].concat(_toConsumableArray(invoiceData.items),[{name:'',quantity:0,price:0,total:0,id:uuidv4()}])}));};var onDeleteItem=function onDeleteItem(id){var newItems=invoiceData.items.filter(function(item){return item.id!==id;});setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{items:newItems,total:getTotal(newItems)}));};var handleChangeItemValue=function handleChangeItemValue(e,index){var inputName=e.target.name;var value=e.target.value;var newItems=updateItemFields(invoiceData,index,inputName,value);setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{items:newItems,total:getTotal(newItems)}));};var clear=function clear(){dispatch(handleCurrentId(null));setInvocieData(data);};var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(currentId){dispatch(updateInvoice(currentId,invoiceData));dispatch(handleCurrentId(null));history.push('/');}else{dispatch(createInvoice(invoiceData));dispatch(getInvoices());}dispatch(toggleFormShow());clear();case 4:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();useEffect(function(){if(invoice)setInvocieData(invoice);if(!currentId)clear();// eslint-disable-next-line\n},[currentId]);return/*#__PURE__*/_jsx(Modal,{open:showForm===undefined?false:showForm,onClose:function onClose(){return dispatch(toggleFormShow());},\"aria-labelledby\":\"simple-modal-title\",\"aria-describedby\":\"simple-modal-description\"// style={{ display: showForm ? 'block' : 'none' }}\n,className:classes.root,children:/*#__PURE__*/_jsx(Container,{className:classes.formContainer,children:/*#__PURE__*/_jsxs(Paper,{className:classes.paper,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:currentId?\"Edit #\".concat(currentId.slice(18)):'New Invoice'}),/*#__PURE__*/_jsxs(ValidatorForm,{onSubmit:onSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",className:classes.heading,color:\"primary\",children:\"Bill From\"}),/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"Street Address\"}),/*#__PURE__*/_jsx(FormField,{name:\"senderAddress\",value:invoiceData.senderAddress.street,onChange:function onChange(e){return setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{senderAddress:_objectSpread(_objectSpread({},invoiceData.senderAddress),{},{street:e.target.value})}));},fullWidth:true}),/*#__PURE__*/_jsxs(\"div\",{className:classes.flex,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.space,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"City\"}),/*#__PURE__*/_jsx(FormField,{name:\"senderCity\",value:invoiceData.senderAddress.city,onChange:function onChange(e){return setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{senderAddress:_objectSpread(_objectSpread({},invoiceData.senderAddress),{},{city:e.target.value})}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.space,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"Post Code\"}),/*#__PURE__*/_jsx(FormField,{name:\"senderPostCode\",value:invoiceData.senderAddress.postCode,onChange:function onChange(e){return setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{senderAddress:_objectSpread(_objectSpread({},invoiceData.senderAddress),{},{postCode:e.target.value})}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.space,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"Country\"}),/*#__PURE__*/_jsx(FormField,{name:\"senderCountry\",value:invoiceData.senderAddress.country,onChange:function onChange(e){return setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{senderAddress:_objectSpread(_objectSpread({},invoiceData.senderAddress),{},{country:e.target.value})}));}})]})]}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",className:classes.heading,color:\"primary\",children:\"Bill to\"}),/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"Client's Name\"}),/*#__PURE__*/_jsx(FormField,{name:\"clientName\",value:invoiceData.clientName,fullWidth:true,onChange:function onChange(e){return setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{clientName:e.target.value}));}}),/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"Client's Email\"}),/*#__PURE__*/_jsx(FormField,{name:\"clientEmail\",value:invoiceData.clientEmail,fullWidth:true,onChange:function onChange(e){return setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{clientEmail:e.target.value}));},validators:['required','isEmail'],errorMessages:[\"can't be empty\",'email is invalid']}),/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"Street Address\"}),/*#__PURE__*/_jsx(FormField,{name:\"clientStreet\",value:invoiceData.clientAddress.street,fullWidth:true,onChange:function onChange(e){return setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{clientAddress:_objectSpread(_objectSpread({},invoiceData.clientAddress),{},{street:e.target.value})}));}}),/*#__PURE__*/_jsxs(\"div\",{className:classes.flex,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.space,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"City\"}),/*#__PURE__*/_jsx(FormField,{name:\"clientCity\",value:invoiceData.clientAddress.city,onChange:function onChange(e){return setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{clientAddress:_objectSpread(_objectSpread({},invoiceData.clientAddress),{},{city:e.target.value})}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.space,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"Post Code\"}),/*#__PURE__*/_jsx(FormField,{name:\"clientPostCode\",value:invoiceData.clientAddress.postCode,onChange:function onChange(e){return setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{clientAddress:_objectSpread(_objectSpread({},invoiceData.clientAddress),{},{postCode:e.target.value})}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.space,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"Country\"}),/*#__PURE__*/_jsx(FormField,{name:\"clientCountry\",value:invoiceData.clientAddress.country,onChange:function onChange(e){return setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{clientAddress:_objectSpread(_objectSpread({},invoiceData.clientAddress),{},{country:e.target.value})}));}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.flex,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"Invoice Date\"}),/*#__PURE__*/_jsx(FormField,{name:\"createdAt\",type:\"date\",value:invoiceData.createdAt,fullWidth:true,onChange:function onChange(e){setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{createdAt:e.target.value,paymentDue:invoiceData.paymentTerms?getDueDate(e.target.value,invoiceData.paymentTerms):''}));}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"Payment terms\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(SelectValidator,{name:\"paymentTerms\",value:invoiceData.paymentTerms,validators:['required'],errorMessages:[\"can't be empty\"],onChange:function onChange(e){setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{paymentTerms:e.target.value,paymentDue:invoiceData.createdAt?getDueDate(invoiceData.createdAt,e.target.value):''}));},children:[/*#__PURE__*/_jsx(MenuItem,{value:'',children:/*#__PURE__*/_jsx(\"em\",{children:\"None\"})}),/*#__PURE__*/_jsx(MenuItem,{value:30,children:\"Next 30 days\"}),/*#__PURE__*/_jsx(MenuItem,{value:14,children:\"Next 14 days\"}),/*#__PURE__*/_jsx(MenuItem,{value:7,children:\"Next 7 day\"}),/*#__PURE__*/_jsx(MenuItem,{value:1,children:\"Next 1 day\"})]})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:\"Project Description\"}),/*#__PURE__*/_jsx(FormField,{name:\"description\",value:invoiceData.description,fullWidth:true,onChange:function onChange(e){return setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{description:e.target.value}));}}),invoiceData.items.length>0&&/*#__PURE__*/_jsx(ItemsList,{items:invoiceData.items,handleChangeItem:handleChangeItemValue,deleteItem:onDeleteItem})]}),/*#__PURE__*/_jsxs(Button,{variant:\"contained\",fullWidth:true,className:classes.btnList,onClick:addItemField,children:[/*#__PURE__*/_jsx(AddIcon,{}),\"Add New Item\"]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.btnGroup,children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:function onClick(){return dispatch(toggleFormShow());},className:classes.btn,children:currentId?'Cancel':'Discard'}),/*#__PURE__*/_jsxs(\"div\",{className:classes.btnRight,children:[/*#__PURE__*/_jsx(Button,{style:{display:currentId?'none':'inline'},className:classes.btn,variant:\"outlined\",type:\"submit\",onClick:function onClick(){return setInvocieData(_objectSpread(_objectSpread({},invoiceData),{},{status:'draft'}));},children:\"Save As Draft\"}),/*#__PURE__*/_jsx(Button,{className:classes.btn,variant:\"contained\",color:\"primary\",type:\"submit\",children:currentId?'Save Changes':'Save & Add'})]})]})]})]})})});};export default Form;","map":{"version":3,"sources":["/Users/mohamednasr/Desktop/web/projects/invoce_app/client/src/components/Form/Form.js"],"names":["React","useState","useEffect","FormField","ItemsList","createInvoice","getInvoices","updateInvoice","useDispatch","useSelector","toggleFormShow","handleCurrentId","data","getTotal","getDueDate","updateItemFields","Container","Typography","MenuItem","Button","Paper","Modal","useHistory","AddIcon","useStyles","ValidatorForm","SelectValidator","v4","uuidv4","Form","classes","history","dispatch","showForm","state","globalState","currentId","invoice","invoices","find","_id","invoiceData","setInvocieData","addItemField","items","name","quantity","price","total","id","onDeleteItem","newItems","filter","item","handleChangeItemValue","e","index","inputName","target","value","clear","onSubmit","preventDefault","push","undefined","root","formContainer","paper","slice","heading","label","senderAddress","street","flex","space","city","postCode","country","clientName","clientEmail","clientAddress","createdAt","paymentDue","paymentTerms","description","length","btnList","btnGroup","btn","btnRight","display","status"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport FormField from './FormField/FormField';\nimport ItemsList from './ItemsList/ItemsList';\nimport {\n  createInvoice,\n  getInvoices,\n  updateInvoice,\n} from '../../actions/invoices';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { toggleFormShow, handleCurrentId } from '../../actions/genralState';\nimport { data, getTotal, getDueDate, updateItemFields } from '../../helpers';\nimport {\n  Container,\n  Typography,\n  MenuItem,\n  Button,\n  Paper,\n  Modal,\n} from '@material-ui/core';\nimport { useHistory } from 'react-router-dom';\nimport AddIcon from '@material-ui/icons/Add';\nimport useStyles from './styles';\nimport {\n  ValidatorForm,\n  SelectValidator,\n} from 'react-material-ui-form-validator';\nimport { v4 as uuidv4 } from 'uuid';\n\nconst Form = () => {\n  const classes = useStyles();\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const showForm = useSelector((state) => state.globalState.showForm);\n  const currentId = useSelector((state) => state.globalState.currentId);\n  const invoice = useSelector((state) =>\n    currentId\n      ? state.invoices.invoices.find((invoice) => invoice._id === currentId)\n      : null\n  );\n\n  const [invoiceData, setInvocieData] = useState(data);\n\n  const addItemField = () => {\n    setInvocieData({\n      ...invoiceData,\n      items: [\n        ...invoiceData.items,\n        {\n          name: '',\n          quantity: 0,\n          price: 0,\n          total: 0,\n          id: uuidv4(),\n        },\n      ],\n    });\n  };\n\n  const onDeleteItem = (id) => {\n    const newItems = invoiceData.items.filter((item) => item.id !== id);\n    setInvocieData({\n      ...invoiceData,\n      items: newItems,\n      total: getTotal(newItems),\n    });\n  };\n\n  const handleChangeItemValue = (e, index) => {\n    const inputName = e.target.name;\n    let value = e.target.value;\n\n    const newItems = updateItemFields(invoiceData, index, inputName, value);\n\n    setInvocieData({\n      ...invoiceData,\n      items: newItems,\n      total: getTotal(newItems),\n    });\n  };\n\n  const clear = () => {\n    dispatch(handleCurrentId(null));\n    setInvocieData(data);\n  };\n\n  const onSubmit = async (e) => {\n    e.preventDefault();\n\n    if (currentId) {\n      dispatch(updateInvoice(currentId, invoiceData));\n      dispatch(handleCurrentId(null));\n      history.push('/');\n    } else {\n      dispatch(createInvoice(invoiceData));\n      dispatch(getInvoices());\n    }\n\n    dispatch(toggleFormShow());\n    clear();\n  };\n\n  useEffect(() => {\n    if (invoice) setInvocieData(invoice);\n\n    if (!currentId) clear();\n\n    // eslint-disable-next-line\n  }, [currentId]);\n\n  return (\n    <Modal\n      open={showForm === undefined ? false : showForm}\n      onClose={() => dispatch(toggleFormShow())}\n      aria-labelledby=\"simple-modal-title\"\n      aria-describedby=\"simple-modal-description\"\n      // style={{ display: showForm ? 'block' : 'none' }}\n      className={classes.root}\n    >\n      <Container className={classes.formContainer}>\n        <Paper className={classes.paper}>\n          <Typography variant=\"h4\">\n            {currentId ? `Edit #${currentId.slice(18)}` : 'New Invoice'}\n          </Typography>\n\n          <ValidatorForm onSubmit={onSubmit}>\n            <div>\n              <Typography\n                variant=\"h5\"\n                className={classes.heading}\n                color=\"primary\"\n              >\n                Bill From\n              </Typography>\n              <div className={classes.label}>Street Address</div>\n\n              <FormField\n                name=\"senderAddress\"\n                value={invoiceData.senderAddress.street}\n                onChange={(e) =>\n                  setInvocieData({\n                    ...invoiceData,\n                    senderAddress: {\n                      ...invoiceData.senderAddress,\n                      street: e.target.value,\n                    },\n                  })\n                }\n                fullWidth={true}\n              />\n\n              <div className={classes.flex}>\n                <div className={classes.space}>\n                  <div className={classes.label}>City</div>\n\n                  <FormField\n                    name=\"senderCity\"\n                    value={invoiceData.senderAddress.city}\n                    onChange={(e) =>\n                      setInvocieData({\n                        ...invoiceData,\n                        senderAddress: {\n                          ...invoiceData.senderAddress,\n                          city: e.target.value,\n                        },\n                      })\n                    }\n                  />\n                </div>\n                <div className={classes.space}>\n                  <div className={classes.label}>Post Code</div>\n\n                  <FormField\n                    name=\"senderPostCode\"\n                    value={invoiceData.senderAddress.postCode}\n                    onChange={(e) =>\n                      setInvocieData({\n                        ...invoiceData,\n                        senderAddress: {\n                          ...invoiceData.senderAddress,\n                          postCode: e.target.value,\n                        },\n                      })\n                    }\n                  />\n                </div>\n                <div className={classes.space}>\n                  <div className={classes.label}>Country</div>\n\n                  <FormField\n                    name=\"senderCountry\"\n                    value={invoiceData.senderAddress.country}\n                    onChange={(e) =>\n                      setInvocieData({\n                        ...invoiceData,\n                        senderAddress: {\n                          ...invoiceData.senderAddress,\n                          country: e.target.value,\n                        },\n                      })\n                    }\n                  />\n                </div>\n              </div>\n              <Typography\n                variant=\"h5\"\n                className={classes.heading}\n                color=\"primary\"\n              >\n                Bill to\n              </Typography>\n              <div className={classes.label}>Client's Name</div>\n\n              <FormField\n                name=\"clientName\"\n                value={invoiceData.clientName}\n                fullWidth={true}\n                onChange={(e) =>\n                  setInvocieData({ ...invoiceData, clientName: e.target.value })\n                }\n              />\n              <div className={classes.label}>Client's Email</div>\n\n              <FormField\n                name=\"clientEmail\"\n                value={invoiceData.clientEmail}\n                fullWidth={true}\n                onChange={(e) =>\n                  setInvocieData({\n                    ...invoiceData,\n                    clientEmail: e.target.value,\n                  })\n                }\n                validators={['required', 'isEmail']}\n                errorMessages={[\"can't be empty\", 'email is invalid']}\n              />\n              <div className={classes.label}>Street Address</div>\n\n              <FormField\n                name=\"clientStreet\"\n                value={invoiceData.clientAddress.street}\n                fullWidth={true}\n                onChange={(e) =>\n                  setInvocieData({\n                    ...invoiceData,\n                    clientAddress: {\n                      ...invoiceData.clientAddress,\n                      street: e.target.value,\n                    },\n                  })\n                }\n              />\n              <div className={classes.flex}>\n                <div className={classes.space}>\n                  <div className={classes.label}>City</div>\n\n                  <FormField\n                    name=\"clientCity\"\n                    value={invoiceData.clientAddress.city}\n                    onChange={(e) =>\n                      setInvocieData({\n                        ...invoiceData,\n                        clientAddress: {\n                          ...invoiceData.clientAddress,\n                          city: e.target.value,\n                        },\n                      })\n                    }\n                  />\n                </div>\n                <div className={classes.space}>\n                  <div className={classes.label}>Post Code</div>\n\n                  <FormField\n                    name=\"clientPostCode\"\n                    value={invoiceData.clientAddress.postCode}\n                    onChange={(e) =>\n                      setInvocieData({\n                        ...invoiceData,\n                        clientAddress: {\n                          ...invoiceData.clientAddress,\n                          postCode: e.target.value,\n                        },\n                      })\n                    }\n                  />\n                </div>\n                <div className={classes.space}>\n                  <div className={classes.label}>Country</div>\n\n                  <FormField\n                    name=\"clientCountry\"\n                    value={invoiceData.clientAddress.country}\n                    onChange={(e) =>\n                      setInvocieData({\n                        ...invoiceData,\n                        clientAddress: {\n                          ...invoiceData.clientAddress,\n                          country: e.target.value,\n                        },\n                      })\n                    }\n                  />\n                </div>\n              </div>\n              <div className={classes.flex}>\n                <div>\n                  <div className={classes.label}>Invoice Date</div>\n\n                  <FormField\n                    name=\"createdAt\"\n                    type=\"date\"\n                    value={invoiceData.createdAt}\n                    fullWidth={true}\n                    onChange={(e) => {\n                      setInvocieData({\n                        ...invoiceData,\n                        createdAt: e.target.value,\n                        paymentDue: invoiceData.paymentTerms\n                          ? getDueDate(e.target.value, invoiceData.paymentTerms)\n                          : '',\n                      });\n                    }}\n                  />\n                </div>\n                <div>\n                  <div className={classes.label}>Payment terms</div>\n                  <div>\n                    <SelectValidator\n                      name=\"paymentTerms\"\n                      value={invoiceData.paymentTerms}\n                      validators={['required']}\n                      errorMessages={[\"can't be empty\"]}\n                      onChange={(e) => {\n                        setInvocieData({\n                          ...invoiceData,\n                          paymentTerms: e.target.value,\n                          paymentDue: invoiceData.createdAt\n                            ? getDueDate(invoiceData.createdAt, e.target.value)\n                            : '',\n                        });\n                      }}\n                    >\n                      <MenuItem value={''}>\n                        <em>None</em>\n                      </MenuItem>\n                      <MenuItem value={30}>Next 30 days</MenuItem>\n                      <MenuItem value={14}>Next 14 days</MenuItem>\n                      <MenuItem value={7}>Next 7 day</MenuItem>\n                      <MenuItem value={1}>Next 1 day</MenuItem>\n                    </SelectValidator>\n                  </div>\n                </div>\n              </div>\n              <div className={classes.label}>Project Description</div>\n\n              <FormField\n                name=\"description\"\n                value={invoiceData.description}\n                fullWidth={true}\n                onChange={(e) =>\n                  setInvocieData({\n                    ...invoiceData,\n                    description: e.target.value,\n                  })\n                }\n              />\n              {invoiceData.items.length > 0 && (\n                <ItemsList\n                  items={invoiceData.items}\n                  handleChangeItem={handleChangeItemValue}\n                  deleteItem={onDeleteItem}\n                />\n              )}\n            </div>\n\n            <Button\n              variant=\"contained\"\n              fullWidth\n              className={classes.btnList}\n              onClick={addItemField}\n            >\n              <AddIcon />\n              Add New Item\n            </Button>\n            <div className={classes.btnGroup}>\n              <Button\n                variant=\"contained\"\n                onClick={() => dispatch(toggleFormShow())}\n                className={classes.btn}\n              >\n                {currentId ? 'Cancel' : 'Discard'}\n              </Button>\n              <div className={classes.btnRight}>\n                <Button\n                  style={{ display: currentId ? 'none' : 'inline' }}\n                  className={classes.btn}\n                  variant=\"outlined\"\n                  type=\"submit\"\n                  onClick={() =>\n                    setInvocieData({ ...invoiceData, status: 'draft' })\n                  }\n                >\n                  Save As Draft\n                </Button>\n                <Button\n                  className={classes.btn}\n                  variant=\"contained\"\n                  color=\"primary\"\n                  type=\"submit\"\n                >\n                  {currentId ? 'Save Changes' : 'Save & Add'}\n                </Button>\n              </div>\n            </div>\n          </ValidatorForm>\n        </Paper>\n      </Container>\n    </Modal>\n  );\n};\n\nexport default Form;\n"]},"metadata":{},"sourceType":"module"}